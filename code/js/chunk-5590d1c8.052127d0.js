(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5590d1c8"],{"1d6a":function(t,e,s){"use strict";s("2eb3")},"2eb3":function(t,e,s){},6073:function(t,e,s){},6556:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("div",{staticClass:"tabs"},[s("div",{staticClass:"tab",class:{active:!t.isPendant},on:{click:function(e){t.isPendant=!1}}},[t._v("个人头像")]),s("div",{staticClass:"tab",class:{active:t.isPendant},on:{click:function(e){t.isPendant=!0}}},[t._v("主页挂件")])]),t.isPendant||t.currentList.data.length?t._e():s("div",{staticClass:"empty"},[s("div",{staticClass:"icon"}),s("p",{staticClass:"text"},[t._v("暂无购买记录")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isPendant&&t.currentList.data&&t.currentList.data.length,expression:"!isPendant && currentList.data && currentList.data.length"}],staticClass:"overflow-auto"},[s("s-infinite",{attrs:{disabled:t.currentList.locked,distance:0},on:{load:t.loadMore}},[s("ul",t._l(t.currentList.data,(function(e){return s("li",{key:e.id,class:{expired:1===e.expireFlag}},[s("img",{staticClass:"cover",attrs:{src:e.commodityUrl}}),s("div",{staticClass:"info"},[s("div",{staticClass:"desc"},[s("div",{staticClass:"name"},[t._v(" "+t._s(e.commodityName||e.itemName)+" "),e.onShelf?1===e.expireFlag?s("span",{staticClass:"expire"},[t._v("已过期")]):e.expireTips?s("span",{staticClass:"expire"},[t._v(t._s(e.expireTipsText))]):t._e():s("span",{staticClass:"expire gray"},[t._v("已下架")])]),s("div",{staticClass:"price"},[s("span",{staticClass:"icon"}),s("span",{staticClass:"num"},[t._v(t._s(e.orderPrice||e.payPrice))])]),s("div",{staticClass:"time"},[t._v("获得时间："+t._s(t._f("formatTime")(e.createTime)))]),e.endTime?s("div",{staticClass:"time"},[t._v("到期时间："+t._s(t._f("formatTime")(e.endTime)))]):t._e()]),s("div",{staticClass:"btn-wrap"},[1===t.activeIndex?[s("div",{staticClass:"gray-text"},[t._v("已赠送")])]:[!e.forever&&e.onShelf?s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"btn",on:{click:function(s){return t.buy(e)}}},[t._v("续费")]):t._e(),e.canSetting&&0===e.useState?s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"btn border",on:{click:function(s){return t.useItem(e)}}},[t._v("装扮")]):e.canSetting||0!==e.useState?s("div",{staticClass:"btn border disabled"},[t._v("已装扮")]):s("div",{})]],2)])])})),0)])],1),s("PendantList",{directives:[{name:"show",rawName:"v-show",value:t.isPendant,expression:"isPendant"}]}),s("Buy",{attrs:{visible:t.visibleBuy,product:t.currentProduct,userGender:t.userGender,renew:!0},on:{"update:visible":function(e){t.visibleBuy=e},renewSuccess:t.renewSuccess}})],1)},a=[],n=s("9ab4"),c=s("60a3"),r=s("c949"),d=s("5a0c"),o=s.n(d),l=s("c4a0"),u=s.n(l),v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pendant"},[t.firstLoaded&&0===t.currentList.data.length?s("div",{staticClass:"empty"},[s("div",{staticClass:"icon"}),s("p",{staticClass:"text"},[t._v("暂无购买记录")])]):s("div",{staticClass:"overflow-auto"},[s("s-infinite",{attrs:{disabled:t.currentList.locked,distance:0},on:{load:t.loadMore}},[s("ul",t._l(t.currentList.data,(function(e){return s("li",{key:e.id,class:{expired:1===e.expireFlag}},[s("img",{staticClass:"cover",attrs:{src:e.commodityUrl}}),s("div",{staticClass:"info"},[s("div",{staticClass:"desc"},[s("div",{staticClass:"name"},[t._v(" "+t._s(e.commodityName||e.itemName)+" "),e.online?1===e.expireFlag?s("span",{staticClass:"expire"},[t._v("已过期")]):e.expireTips?s("span",{staticClass:"expire"},[t._v(t._s(e.expireTips))]):t._e():s("span",{staticClass:"expire gray"},[t._v("已下架")])]),s("div",{staticClass:"price"},[s("span",{staticClass:"icon"}),s("span",{staticClass:"num"},[t._v(t._s(e.price))])]),s("div",{staticClass:"time"},[t._v("购买时间："+t._s(t._f("formatTime")(e.createTime)))]),s("div",{staticClass:"time"},[t._v("到期时间："+t._s(t._f("formatTime")(e.expireTime)))])]),s("div",{staticClass:"btn-wrap"},[e.online?s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"btn",on:{click:function(s){return t.buyPendant(e)}}},[t._v("续费")]):s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"btn disabled",on:{click:function(e){return t.toast("此挂件已下架～")}}},[t._v("续费")]),0===e.expireFlag?[1===e.status?s("div",{staticClass:"btn border",on:{click:function(s){return t.useItem(e)}}},[t._v("卸下")]):0===e.status?s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"btn border",on:{click:function(s){return t.useItem(e)}}},[t._v("装扮")]):t._e()]:[1===e.status?s("div",{staticClass:"btn border disabled"},[t._v("装扮")]):t._e()]],2)])])})),0)])],1),s("BuyPendant",{attrs:{visible:t.visibleBuyPendant,itemIdentity:t.itemIdentity,renew:!0},on:{"update:visible":function(e){t.visibleBuyPendant=e},buySuccess:t.buySuccess}})],1)},m=[],p=s("1a13");let h=class extends c["g"]{constructor(){super(...arguments),this.visibleBuyPendant=!1,this.currentList={offset:0,pageNum:1,data:[],locked:!0,loaded:!1},this.firstLoaded=!1,this.itemIdentity=""}toast(t){u.a.toast({type:"success",text:t})}async buyPendant(t){t.online?(this.itemIdentity=t.itemIdentity,this.visibleBuyPendant=!0):u.a.toast({type:"success",text:"商品已下架"})}async useItem(t){let e=0;0===t.status?e=1:1===t.status&&(e=0),await Object(r["a"])(t.itemIdentity,e),this.currentList.data.some(t=>{if(1===t.status)return t.status=0,!0}),t.status=e,u.a.toast({type:"success",text:1===e?"装扮成功":"卸下成功"})}buySuccess(t){this.currentList={offset:0,pageNum:1,data:[],locked:!0,loaded:!1},this.loadMore()}async getList(){const t=await Object(r["A"])(this.currentList.pageNum);this.firstLoaded=!0,t&&this.currentList.data.push(...t),this.currentList.pageNum++,this.currentList.locked=!0,this.currentList.loaded=!1,t&&t.length||(this.currentList.loaded=!0)}loadMore(){this.currentList.locked=!1,this.currentList.loaded?this.$nextTick(()=>this.currentList.locked=!0):this.getList()}created(){this.loadMore()}};h=Object(n["a"])([Object(c["a"])({filters:{formatTime(t){return o()(t).format("YYYY-MM-DD HH:mm")},getTimeText(t){let e;switch(t){case 0:e="购买";break;case 1:e="赠送";break;case 2:e="获赠";break;default:e="购买";break}return e}},components:{BuyPendant:p["a"]}})],h);var y=h,b=y,f=(s("f4e9"),s("2877")),g=Object(f["a"])(b,v,m,!1,null,"0cffb0af",null),_=g.exports,C=s("d36d");let x=class extends c["g"]{constructor(){super(...arguments),this.isPendant=!1,this.activeIndex=0,this.visibleBuy=!1,this.currentProduct=null,this.userGender="1",this.product=[{offset:0,pageCursor:void 0,data:[],locked:!0,loaded:!1}]}get currentList(){return this.product[this.activeIndex]}toast(t){u.a.toast({type:"scucess",text:t})}changeSelectTab(t){this.activeIndex=t,this.product[t].data.length||this.loadMore(),this.$nextTick(()=>{})}async buy(t){const e=await Object(r["w"])(t.commodityIdentity||t.itemIdentity);e.online?(this.currentProduct=e,this.visibleBuy=!0):u.a.toast({type:"success",text:"商品已下架"})}renewSuccess(){location.reload()}async useItem(t){let e;if(u.a.trackEvent("clk","AvatarShop_OrderList_Equip",{GoodsId:String(t.commodityIdentity||t.itemIdentity)}),e=0===this.activeIndex?await Object(r["d"])(t.id,t.commodityIdentity||t.itemIdentity,1):await Object(r["c"])(t.commodityIdentity||t.itemIdentity,1),1001===e.resultCode){this.currentList.data.forEach(t=>{t.useState=0}),t.useState=1,u.a.toast({type:"success",text:"装扮成功"});const e=t.commodityUrl.lastIndexOf("/")+1,s=t.commodityUrl.slice(e).split(".")[0];s&&u.a.dispatch("action_event_saveAvatar",{name:s})}else u.a.toast({type:"error",text:e.resultDesc})}async getList(){const t=this.product[this.activeIndex];let e=[r["G"]][this.activeIndex];const s=await e(t.pageCursor);s&&s.data&&(t.data.push(...s.data),t.pageCursor=s.pageCursor),t.locked=!0,t.loaded=!1,"-1"!==t.pageCursor&&s&&s.data&&s.data.length||(t.loaded=!0)}loadMore(){this.currentList.locked=!1,this.currentList.loaded?this.$nextTick(()=>this.currentList.locked=!0):this.getList()}async initUserGender(){this.userGender=String((await Object(r["S"])()).gender)}trackPv(){u.a.trackEvent("pv","AvatarShop_OrderList")}created(){this.initUserGender(),this.activeIndex=Number(this.$route.query.activeIndex||0),this.loadMore()}setNavigationRight(){u.a.setNavigationRight({title:"交易明细"}),u.a.onNavigationRightClick(()=>{u.a.navigateTo({url:`${location.origin}${location.pathname}#/market/purchased/detail`})})}mounted(){this.setNavigationRight(),u.a.onShow(this.trackPv)}};x=Object(n["a"])([Object(c["a"])({components:{Buy:C["a"],PendantList:_},filters:{formatTime(t){return o()(t).format("YYYY-MM-DD HH:mm")}}})],x);var k=x,L=k,w=(s("1d6a"),Object(f["a"])(L,i,a,!1,null,"f6532590",null));e["default"]=w.exports},f4e9:function(t,e,s){"use strict";s("6073")}}]);
//# sourceMappingURL=chunk-5590d1c8.052127d0.js.map
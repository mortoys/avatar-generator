(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c227c5c0"],{"06e9":function(t,e,i){t.exports=i.p+"img/arrow-right.67625fa8.png"},"11ee":function(t,e,i){t.exports=i.p+"img/icon_original.bf81af7d.png"},"12aa7":function(t,e,i){t.exports=i.p+"img/default-head.2bc781f6.png"},2030:function(t,e,i){"use strict";i("aba7")},2355:function(t,e,i){t.exports=i.p+"img/icon_fairy.9d1b48e7.png"},"2b01":function(t,e,i){t.exports=i.p+"img/icon_melancholy.2c696ef8.png"},4939:function(t,e,i){t.exports=i.p+"img/card-2.c60abbba.png"},"4ccc":function(t,e,i){t.exports=i.p+"img/default-head.2bc781f6.png"},"4f7e":function(t,e,i){t.exports=i.p+"img/back.35bdcbfa.png"},5629:function(t,e,i){t.exports=i.p+"img/coin.523f08c4.png"},"5ac8":function(t,e,i){},"5b06e":function(t,e,i){},"645d":function(t,e,i){"use strict";i("e6a3")},"745c":function(t,e,i){},7730:function(t,e,i){"use strict";var s=i("9ab4"),a=i("c4a0"),n=i.n(a),r=i("60a3"),c=i("c949");let o=class extends r["g"]{constructor(){super(...arguments),this.searchValue="",this.visibleBuy=!1,this.currentProduct=null,this.showSearchBtn=!0}openSearchKeyboard(){this.showSearchBtn=!1,n.a.keyboard({maxLen:5,content:this.searchValue,placeholder:"请输入完整的头像名称～",fail:t=>{console.info("keyboard fail:",t),t.msg&&(this.searchValue=String(t.msg))},success:async t=>{if(console.info("keyboard success:",t),!t.data)return;this.searchValue=String(t.data);const e=await Object(c["mb"])(this.searchValue);e?(this.currentProduct=e,this.visibleBuy=!0,this.searchValue=""):(this.openSearchKeyboard(),n.a.toast({type:"error",text:"该头像不存在，请输入正确名称"}))},complete:async t=>{console.info("keyboard complete:",t),this.showSearchBtn=!0,this.searchValue=String(t.data)}})}};o=Object(s["a"])([r["a"]],o),e["a"]=o},"7fd9":function(t,e,i){t.exports=i.p+"img/default-head.2bc781f6.png"},"8a2c":function(t,e,i){"use strict";function s(t){const e=[36,37];return e[Number(t)]}i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return a}));const a=Object.freeze([{iconUrl:"",desc:"集合全平台优质头像，轻松变变变～",title:"全部",index:0,sources:[1001,1002]},{iconUrl:i("c05f"),desc:"",title:"怀旧",index:999,sources:[39,40]},{iconUrl:i("9648"),desc:"人生辣么苦，只有我是草莓味",title:"可爱",index:1,sources:[26,27]},{iconUrl:i("ac2f"),desc:"暗黑系魅力，神秘而强大",title:"暗黑",index:2,sources:[28,29]},{iconUrl:i("2b01"),desc:"如果爱有颜色，那一定是遥远的克莱因蓝",title:"忧郁",index:3,sources:[30,31]},{iconUrl:i("2355"),desc:"仙气飘飘，清夜无尘，月色如银",title:"仙风",index:4,sources:[32,33]},{iconUrl:i("11ee"),desc:"我的头像，天生闪耀独特光芒",title:"创意",index:5,sources:[34,35]},{iconUrl:"",desc:"",title:"挂件",index:666,sources:[26,26]}])},"8c92":function(t,e,i){t.exports=i.p+"img/diamond.de7e3486.png"},9648:function(t,e,i){t.exports=i.p+"img/icon_cute.51135977.png"},"9d6a":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h4",[t._v("Soul个性商城服务声明")]),i("div",{staticClass:"content"},[i("p",{staticClass:"storage-flag-buy"},[t._v("更新日期：【2021】年【8】月【4】日"),i("span",{staticClass:"hidden-flag"})]),i("p",[t._v("生效日期：【2021】年【8】月【4】日")]),i("p",[t._v("“Soul个性商城”是Soul提供给用户的一项下载、使用虚拟商品的平台服务，相关虚拟商品由Soul或第三方（以下称为“创作者”）提供，用户可以通过Soul个性商城付费或免费下载虚拟商品，并在Soul的相关产品及功能中进行使用。本声明为《Soul App用户服务协议》《Soul币用户协议》不可分割的一部分，用户使用Soul个性商城，需遵守上述协议及本声明如下条款：")]),i("p",[t._v("1.您理解并同意，Soul仅为用户提供虚拟商品下载及使用的平台，除用户通过本人Soul帐号在个性商城下载后自行在本人Soul帐号中使用外，未经Soul或相关权利人书面许可，任何人不得以其他任何形式对该等虚拟商品进行使用或创造任何衍生产品/作品。")]),i("p",[t._v("2.您在Soul个性商城所下载的虚拟商品会与您的Soul帐号绑定，但仅限于您下载时所使用的Soul帐号。为确保虚拟商品的正常使用，请您使用本人Soul帐号进行下载。我们会统计虚拟商品的下载情况，用于Soul个性商城及其他Soul产品或功能的日常推广参考。")]),i("p",[t._v("3.Soul个性商城的付费购买功能是Soul为Soul用户自愿就创作者提供的付费虚拟商品进行付费购买以获得使用许可的行为提供相应技术支持的功能。您是否付费，由您自行决定，但付费后除因法定情形或其他相关规定的原因外不可撤回。创作者将基于您的付费金额获得收益。")]),i("p",[t._v("4.Soul坚决反对任何违反法律法规或侵犯第三方合法权益的内容。如经Soul判断认为创作者的虚拟商品或创作者的任何行为存在违反法律法规、侵犯第三方合法权益及/或违反Soul不时发布的各种规范、规则的情形，Soul有权将相应虚拟商品进行下架、屏蔽或删除处理（包括您已经付费购买的虚拟商品）。您理解并同意，因上述原因导致您不能正常使用Soul个性商城或相关虚拟商品（包括您已经付费购买的商品），或给您造成损失的，Soul不承担责任。")]),i("p",[t._v("5.因创作者的虚拟商品产生的任何纠纷、责任等，以及创作者违反法律法规、侵犯第三方合法权益及/或违反Soul不时发布的各种规范、规则所引发的任何后果，均由创作者独立承担责任、赔偿损失，与Soul无关。如侵害到Soul及其关联公司、Soul用户或其他第三方权益的，创作者须自行承担全部责任并赔偿一切损失。")]),i("p",[t._v("6.Soul个性商城及其相关虚拟商品仅在Soul App部分软件版本上提供，请您确认所使用的软件版本支持个性商城功能，否则您将无法下载、使用虚拟商品。")]),i("p",[t._v("7.Soul个性商城的服务是按照现有技术和条件所能达到的现状提供的。Soul会尽最大努力向您提供服务，确保服务的连贯性和安全性；但Soul不能保证其所提供的服务毫无瑕疵，也无法随时预见和防范法律、技术以及其他风险，包括但不限于不可抗力、病毒、木马、黑客攻击、系统不稳定、第三方服务瑕疵、政府行为等原因可能导致的服务中断、数据丢失以及其他的损失和风险。您理解并同意，因上述原因导致您不能正常使用Soul个性商城或相关虚拟商品（包括您已经付费购买的虚拟商品），或给您造成损失的，Soul不承担责任。")]),i("p",[t._v("8.若您有任何违反法律法规、本声明及/或Soul不时发布的各种规范、规则的的情形，Soul有权视您的行为性质，在不事先通知您的情况下，采取包括但不限于中断使用、限制使用、删除相关文件、中止或终止服务、追究法律责任等措施，若因此造成Soul及其关联公司、Soul用户或其他第三方损失的，您应予赔偿。")]),i("p",[t._v("根据用户需求及产品更新的需要，Soul可能会对个性商城功能及本服务声明条款进行修改。如有修改，我们会在产品和网页中显著的位置发布以便及时通知到用户。如果您选择继续使用我们的服务，即表示您已接受修改后的内容。")])])])}],n=i("9ab4"),r=i("60a3");let c=class extends r["g"]{};c=Object(n["a"])([r["a"]],c);var o=c,l=o,d=(i("2030"),i("2877")),u=Object(d["a"])(l,s,a,!1,null,"7227662b",null);e["a"]=u.exports},a64f:function(t,e,i){"use strict";i("5ac8")},aba7:function(t,e,i){},ac2f:function(t,e,i){t.exports=i.p+"img/icon_black.cd372aff.png"},bf48:function(t,e,i){"use strict";i("745c")},c051:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("div",{staticClass:"tabs"},[s("div",{staticClass:"tab",class:{active:"1"===t.gender},on:{click:function(e){return t.changeGender("1")}}},[t._v("女生")]),s("div",{staticClass:"tab",class:{active:"0"===t.gender},on:{click:function(e){return t.changeGender("0")}}},[t._v("男生")])]),t._l([t.boyProduct,t.girlProduct],(function(e,a){return s("s-infinite",{directives:[{name:"show",rawName:"v-show",value:Number(t.gender)===a,expression:"Number(gender) === index"}],key:a,ref:"containerRef",refInFor:!0,staticClass:"container",attrs:{disabled:e.locked,distance:500},on:{load:t.loadMore}},[t.showBanner?s("Banner",{attrs:{banners:t.banners,index:a}}):t._e(),s("div",{staticClass:"modules"},t._l(t.modules,(function(e){return s("div",{directives:[{name:"loading",rawName:"v-loading"}],key:e.index,staticClass:"card",on:{click:function(i){return t.toList(e.index)}}},[s("img",{attrs:{src:e.iconUrl,alt:""}}),t._v(" "+t._s(e.title)+" ")])})),0),s("SuperLimit",{attrs:{gender:String(a),userGender:t.userGender}}),s("div",{staticClass:"goods"},[s("div",{staticClass:"title"},[t._v("全部")]),s("div",{staticClass:"nav"},[s("div",{staticClass:"desc"},[t._v("集合全平台优质头像，轻松变变变～")]),s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"all",on:{click:function(e){return t.toList(0)}}},[t._v("查看全部"),s("img",{attrs:{src:i("06e9"),alt:""}})])]),s("ul",t._l(e.data,(function(e,a){return s("li",{key:a,on:{click:function(i){return t.toBuy(e)}}},[s("div",{staticClass:"cover"},[s("img",{attrs:{src:i("12aa7"),alt:""}}),s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.commodityUrl,expression:"item.commodityUrl"}],attrs:{lazy:"loading"}})]),s("div",{staticClass:"name text-overflow"},[t._v(t._s(e.commodityName))]),s("div",{staticClass:"price"},[s("span",{staticClass:"icon"}),s("span",{staticClass:"num"},[t._v(t._s(e.price))])])])})),0)])],1)})),s("div",{staticClass:"fix-btn search-btn",class:{active:t.showSearchBtn},on:{click:t.openSearchKeyboard}}),s("div",{staticClass:"fix-btn backtop-btn",class:{active:t.showBacktopBtn},on:{click:t.backtop}}),s("Buy",{attrs:{visible:t.visibleBuy,product:t.currentProduct,userGender:t.userGender},on:{"update:visible":function(e){t.visibleBuy=e}}})],2)},a=[],n=i("9ab4"),r=i("2ef0"),c=i("d36d"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isActivity?s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"limited",on:{click:t.toLimit}},[s("div",{staticClass:"title"},[s("div",{staticClass:"left"},[s("div",{staticClass:"super-title"},[s("img",{attrs:{src:i("8c92"),alt:""}}),s("span",{staticClass:"limit-text"},[t._v("超级限定")]),s("div",{staticClass:"countdown"},[s("span",[t._v(t._s(t.countdown.date))]),s("span",[t._v(t._s(t.countdown.hour))]),s("span",[t._v(t._s(t.countdown.minute))])])]),s("div",{staticClass:"sub-title"},[t._v("全网限量，先到先得～")])]),t._m(0)]),s("ul",{staticClass:"container"},[t._l(t.superList,(function(e){var a=e.coinCommodityCasherRModel;return s("li",{key:a.itemIdentity},[s("div",{staticClass:"avatar-wrapper"},[s("img",{attrs:{src:i("4ccc"),alt:""}}),s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a.commodityUrl,expression:"item.commodityUrl"}],attrs:{lazy:"loading",alt:""}}),1===a.expireCommodity?s("div",{staticClass:"limit-time"},[t._v("有效期"+t._s(a.salesUnitValue+a.salesUnit))]):t._e()]),s("div",{staticClass:"avatar-info"},[s("div",{staticClass:"name"},[t._v(t._s(a.commodityName))]),s("div",{staticClass:"price"},[s("img",{attrs:{src:i("5629"),alt:""}}),t._v(t._s(a.price))])]),s("div",{staticClass:"avatar-count"},[a.remainNum?s("div",{staticClass:"limit-count"},[t._v("剩余"+t._s(a.remainNum)+"个")]):s("div",{staticClass:"limit-count"},[t._v("已售罄")])])])})),t._l(2-t.superList.length,(function(e){return s("li",{key:e},[t._m(1,!0),t._m(2,!0),s("div",{staticClass:"avatar-count"})])}))],2)]):t._e()},l=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"right"},[t._v(" 查看全部 "),s("img",{attrs:{src:i("06e9"),alt:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"avatar-wrapper"},[s("img",{attrs:{src:i("4ccc"),alt:""}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"avatar-info"},[i("div",{staticClass:"name"},[t._v("敬请期待")]),i("div",{staticClass:"price"})])}],d=i("c4a0"),u=i.n(d),h=i("60a3"),p=i("c949"),v=i("8a2c"),g=i("d257");let m=class extends h["g"]{constructor(){super(...arguments),this.isActivity=!1,this.endTime=0,this.superList=[],this.countdownTmer=0,this.countdown={date:"00",hour:"00",minute:"00",second:"00"}}toLimit(){u.a.trackEvent("clk","AvatarShop_All",{type:"6"}),u.a.navigateTo({url:`${location.origin}${location.pathname}#/market/limit?disableShare=true&gender=${this.gender}&userGender=${this.userGender}`})}initCountdown(){this.countdownTmer=setInterval(()=>{this.countdown=Object(g["b"])(this.endTime),this.endTime<=Date.now()&&clearInterval(this.countdownTmer)})}getTwoRandom(t){const e=[...t],i=e.filter(t=>t.coinCommodityCasherRModel.remainNum>0),s=2;function a(t,e){if(!t||!t.length)return[];if(t.length<=e)return t.slice(0);let i=t.slice(0),s=t.length,a=s-e;while(s-- >a){let t=Math.floor((s+1)*Math.random()),e=i[t];i[t]=i[s],i[s]=e}return i.slice(a)}if(i.length>=s)return a(i,s);{const t=e.filter(t=>t.coinCommodityCasherRModel.remainNum<=0),n=a(i,s),r=a(t,s-n.length);return[...n,...r]}}async initData(){if(!this.isActivity)return;const t=Object(v["a"])(this.gender),e=await Object(p["Q"])(t,20);if(!e.data.length||1===e.data.length){const t=Object(v["a"])("1"===this.gender?"0":"1"),i=await Object(p["Q"])(t,20);e.data.push(...this.getTwoRandom(i.data).slice(0,2-e.data.length))}const i=this.getTwoRandom(e.data);this.superList.push(...i)}async created(){const{openFlag:t,endTime:e}=await Object(p["P"])();this.isActivity=t,this.endTime=e,this.initCountdown(),this.initData()}beforeDestroy(){clearInterval(this.countdownTmer)}};Object(n["a"])([Object(h["d"])()],m.prototype,"gender",void 0),Object(n["a"])([Object(h["d"])()],m.prototype,"userGender",void 0),m=Object(n["a"])([h["a"]],m);var b=m,f=b,y=(i("ed8c"),i("2877")),_=Object(y["a"])(f,o,l,!1,null,"c1f2cc04",null),S=_.exports,w=i("7730"),C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showBanner?i("div",{staticClass:"banner"},[i("div",{staticClass:"swiper"},[i("div",{ref:"container",staticClass:"swiper-container",class:"swiper-container"+t.index},[i("div",{staticClass:"swiper-wrapper",on:{click:function(e){return t.eventHandle(e)}}},t._l(t.banners,(function(t,e){return i("div",{key:e,staticClass:"swiper-slide",attrs:{"data-index":e}},[i("img",{attrs:{src:t.showImage,"data-index":e}})])})),0),i("div",{ref:"pagination",staticClass:"swiper-pagination ignore",class:"swiper-pagination"+t.index})])])]):t._e()},x=[];let k=class extends h["g"]{constructor(){super(...arguments),this.showBanner=!0}async initSwiper(t){t.length?this.$nextTick(()=>{const t=this.banners.length>1;new window.Swiper(".swiper-container"+this.index,{loop:t,autoplay:!0,observer:!0,observeParents:!0,pagination:{el:".swiper-pagination"+this.index}})}):this.showBanner=!1}eventHandle(t){const e=Number(t.target.dataset.index);this.toNext(this.banners[e].jumpUrl)}toNext(t){t&&u.a.navigateToNative(t)}};Object(n["a"])([Object(h["d"])()],k.prototype,"banners",void 0),Object(n["a"])([Object(h["d"])()],k.prototype,"index",void 0),Object(n["a"])([Object(h["f"])("container")],k.prototype,"container",void 0),Object(n["a"])([Object(h["f"])("pagination")],k.prototype,"pagination",void 0),Object(n["a"])([Object(h["h"])("banners")],k.prototype,"initSwiper",null),k=Object(n["a"])([h["a"]],k);var O=k,j=O,A=(i("645d"),Object(y["a"])(j,C,x,!1,null,"11040c46",null)),T=A.exports;let N=class extends(Object(h["c"])(w["a"])){constructor(){super(...arguments),this.visibleBuy=!1,this.gender="1",this.userGender="1",this.boyProduct={locked:!0,loaded:!1,first:0,data:[]},this.girlProduct={locked:!0,loaded:!1,first:0,data:[]},this.showBanner=!0,this.banners=[],this.users=[],this.currentProduct=null,this.userCards=[i("e62b8"),i("4939"),i("d193")],this.modules=v["b"].filter(t=>t.iconUrl),this.showSearchBtn=!0,this.showBacktopBtn=!1,this.showTips=!1,this.tipsTimer=0,this.timmer=0,this.locked=!0,this.loaded=!1}get source(){return v["b"][0].sources[Number(this.gender)]}scroll(t){const e=t.target.classList;e&&e.contains("modules")||(clearTimeout(this.timmer),this.timmer=setTimeout(()=>{if(this.showSearchBtn=!0,!this.containerRef[this.gender])return;const t=this.containerRef[this.gender].$el.scrollTop,e=document.body.clientHeight;this.showBacktopBtn=t>2*e},300),this.showSearchBtn=!1,this.showBacktopBtn=!1)}backtop(){this.showBacktopBtn=!1;const t=this.containerRef[this.gender].$el;let e=setInterval(()=>{let i=Math.floor(-t.scrollTop/5);t.scrollTop=t.scrollTop+i,0===t.scrollTop&&clearInterval(e)},16)}toBuy(t){u.a.trackEvent("clk","AvatarShop_GoodsClk",{GoodsId:String(t.itemIdentity)}),this.currentProduct=t,this.visibleBuy=!0}toList(t){u.a.trackEvent("clk","AvatarShop_All",{type:String(t)}),u.a.navigateTo({url:`${location.origin}${location.pathname}#/market/list?disableShare=true&gender=${this.gender}&userGender=${this.userGender}&activeIndex=${t}`})}async follow(t){try{await Object(p["nb"])(t.userId),t.followStatus=!0}catch(e){u.a.toast({text:"网络异常",type:"success"})}}changeGender(t){this.gender!==t&&(this.gender=t,"1"===this.gender&&this.girlProduct.data.length||"0"===this.gender&&this.boyProduct.data.length||this.loadMore())}async getList(){const t=30,e="0"===this.gender?this.boyProduct:this.girlProduct,i=await Object(p["i"])(this.source,e.first,t);e.first=1,0===i.length?(e.locked=!0,e.loaded=!0):(e.data.push(...i),e.locked=!0,e.loaded=!1)}async loadMore(){const t="0"===this.gender?this.boyProduct:this.girlProduct;t.locked=!1,t.loaded?await new Promise(e=>{this.$nextTick(()=>{t.locked=!0,e(null)})}):await this.getList()}async getBanner(){const t=await Object(p["B"])("62");t&&t.length?this.banners=t.filter(t=>t.positionDetailCode.includes("PERSONALITY_MALL_HEAD_BANNER")):this.showBanner=!1}async getUsers(){this.users=await Object(p["K"])()}async initBridge(){let t,e="https://fe-cdn.soulapp.cn/activity/text-163694.png";u.a.setNavigationRight({imageUrl:e}),u.a.onNavigationRightClick(Object(r["throttle"])(()=>{u.a.trackEvent("clk","AvatarShop_MyOrder");let e="https://fe-cdn.soulapp.cn/activity/text-163694.png";u.a.setNavigationRight({imageUrl:e});const i=u.a.getStorage("MARKET_PURCHASED_EXPIREDLIST"),s=i.split(",")||[];if(t&&2===t.source){const e=t.avatarName+"_"+t.expireTime;s.includes(e)||(s.push(e),u.a.setStorage("MARKET_PURCHASED_EXPIREDLIST",s.join(","))),u.a.navigateTo({url:`${location.origin}${location.pathname}#/market/purchased`})}else u.a.navigateTo({url:`${location.origin}${location.pathname}#/market/purchased`})},800,{leading:!0,trailing:!1}));const i=await Object(p["m"])();if(t=i.almostExpiredAvatar,t&&2===t.source){const i=u.a.getStorage("MARKET_PURCHASED_EXPIREDLIST"),s=i.split(",")||[],a=t.avatarName+"_"+t.expireTime;s.includes(a)||(e="https://fe-cdn.soulapp.cn/activity/text-dot-163694.png",u.a.setNavigationRight({imageUrl:e}))}}async initUserGender(){this.userGender=String((await Object(p["S"])()).gender)}trackPv(){u.a.trackEvent("pv","AvatarShop_Main")}created(){const t=this.$route.query.gender;this.gender=t||"1",this.initUserGender(),this.initBridge(),this.getBanner()}mounted(){u.a.onShow(this.trackPv),this.loadMore(),this.$nextTick(()=>{window.addEventListener("scroll",this.scroll,!0)})}};Object(n["a"])([Object(h["f"])("containerRef")],N.prototype,"containerRef",void 0),N=Object(n["a"])([Object(h["a"])({components:{Buy:c["a"],Banner:T,SuperLimit:S}})],N);var I=N,E=I,B=(i("a64f"),Object(y["a"])(E,s,a,!1,null,"655fe469",null));e["default"]=B.exports},c05f:function(t,e,i){t.exports=i.p+"img/icon_old.292da4ff.png"},d193:function(t,e,i){t.exports=i.p+"img/card-3.dbfb5c83.png"},d36d:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("s-drager",{attrs:{visible:t.visibleSync,"full-screen":!1},on:{"update:visible":function(e){t.visibleSync=e},hide:function(e){t.visibleSync=!1}}},[[!t.isShowAgreement&&t.product?s("div",{staticClass:"buy_container"},[t.product?[s("div",{staticClass:"img-wrap"},[s("img",{directives:[{name:"show",rawName:"v-show",value:!t.imgLoaded,expression:"!imgLoaded"}],staticClass:"avatar",attrs:{src:i("7fd9"),alt:""}}),s("img",{directives:[{name:"show",rawName:"v-show",value:t.imgLoaded,expression:"imgLoaded"}],staticClass:"avatar",attrs:{src:t.product.commodityUrl}})]),s("div",{staticClass:"name"},[t._v(" "+t._s(t.product.commodityName||t.product.itemName)+" "),"天"===t.product.salesUnit?s("div",{staticClass:"expire"},[t._v("有效期"+t._s(t.product.salesUnitValue)+"天")]):t._e()]),s("div",{staticClass:"price"},[s("span",{staticClass:"icon"}),s("span",{staticClass:"num"},[t._v(t._s(t.product.price))])]),s("p",{staticClass:"tips"},[t._v("赠送的Soul币不能使用哦")]),s("div",{staticClass:"protocol"},[s("div",{staticClass:"agree",class:{active:t.agree},on:{click:t.selectAgreement}}),s("div",{staticClass:"text"},[s("span",{on:{click:t.selectAgreement}},[t._v("已阅读并同意：")]),s("span",{staticClass:"blue",on:{click:function(e){t.isShowAgreement=!0}}},[t._v("《Soul个性商城用户协议》")])])]),s("div",{staticClass:"btn-box"},[t.renew?[s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"only-btn",on:{click:t.tryBuy}},[t._v("立即续费")])]:t.diffGender?[s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"only-btn",on:{click:function(e){return t.sendGift("2")}}},[t._v("立即赠送")])]:[s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"left-btn",on:{click:function(e){return t.sendGift("1")}}},[t._v("送给Ta")]),t.goodsInfo?1===t.goodsInfo.useState?s("div",{staticClass:"right-btn disabled"},[t._v("已装扮")]):s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"right-btn",on:{click:t.toUse}},[t._v("立即装扮")]):s("div",{directives:[{name:"loading",rawName:"v-loading"}],staticClass:"right-btn",on:{click:t.tryBuy}},[t._v("立即购买")])]],2)]:t._e()],2):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowAgreement,expression:"isShowAgreement"}],staticClass:"agreement"},[s("img",{staticClass:"back",attrs:{src:i("4f7e"),alt:""},on:{click:function(e){t.isShowAgreement=!1}}}),s("Agreement")],1),s("s-update",{attrs:{visible:t.visibleUpdate},on:{"update:visible":function(e){t.visibleUpdate=e}}})]],2)},a=[],n=i("9ab4"),r=i("60a3"),c=i("c949"),o=i("9d6a"),l=i("c4a0"),d=i.n(l),u=i("5a0c"),h=i.n(u);let p=class extends r["g"]{constructor(){super(...arguments),this.goodsInfo=null,this.isShowAgreement=!1,this.agree=!1,this.visibleUpdate=!1,this.imgLoaded=!1}get diffGender(){return!("1"===this.userGender&&2===this.product.genderType||"0"===this.userGender&&1===this.product.genderType)}async getState(t){t&&(this.loadImg(),this.isShowAgreement=!1,this.goodsInfo=this.stateData||await Object(c["x"])(this.product.itemIdentity))}loadImg(){this.imgLoaded=!1;const t=new Image;t.src=this.product.commodityUrl,t.onload=()=>{this.imgLoaded=!0}}selectAgreement(){if(this.agree=!this.agree,this.agree){const t=document.querySelector(".storage-flag-buy").textContent.replace(/\s/g,"");d.a.setStorage("SOUL_MARKET_AGREEMENT",t),d.a.trackEvent("clk","AvatarShop_Main_agreement_buychoose",{uid:this.$route.query.userIdEcpt,time:h()().format("YYYY-MM-DD")})}}showAgreementTips(){d.a.toast({type:"error",text:"请勾选用户协议"})}updateClientAvatarName(){const t=JSON.parse(this.product.extAttributes).avatarName;t&&d.a.dispatch("action_event_saveAvatar",{name:t})}async toUse(){if(!this.agree)return void this.showAgreementTips();const{success:t,resultDesc:e}=await Object(c["d"])(this.goodsInfo.id,this.product.itemIdentity,1);t?(d.a.toast({type:"success",text:"头像已装扮，去看看吧"}),this.visibleSync=!1,this.updateClientAvatarName()):d.a.toast({type:"success",text:e})}async tryBuy(){if(d.a.trackEvent("clk","AvatarShop_GoodsMain_equip",{GoodsId:String(this.product.itemIdentity)}),!this.agree)return void this.showAgreementTips();const{purchaseSuccess:t,purchaseResultCode:e,purchaseResultDesc:i,purchasePrivilegeDetailResponse:s}=await Object(c["ob"])(this.product.itemIdentity,"",this.renew?"2":"1");if(console.info(t,e,i,s),t){if(this.renew)return this.visibleSync=!1,d.a.toast({type:"success",text:"续费成功"}),void this.$emit("renewSuccess",this.product.itemIdentity);const{success:t}=await Object(c["d"])(s.userPrivilegeId,this.product.itemIdentity,1);t&&(d.a.toast({type:"success",text:"头像购买成功并已装扮，去看看吧"}),this.visibleSync=!1,this.product.remainNum--,this.$emit("buySuccess",this.product.itemIdentity),this.updateClientAvatarName())}else this.buyFailHandle(e,i)}sendGift(t){d.a.trackEvent("clk","AvatarShop_GoodsMain_Send",{GoodsId:this.product.itemIdentity,type:t});const e=-1===d.a.compareVersion("3.94.0",d.a.getAppVersion());e?this.visibleUpdate=!0:this.agree?d.a.dispatch("action_event_selectFriends",{genderType:String(this.product.genderType),checkbox:!1},async t=>{if(!t.data||!t.data.length)return void d.a.toast({type:"error",text:"请选中一个好友后赠送哦~"});const{userIdEcpt:e}=t.data[0],{purchaseSuccess:i,purchaseResultCode:s,purchaseResultDesc:a,purchasePrivilegeDetailResponse:n}=await Object(c["ob"])(this.product.itemIdentity,e);if(i){d.a.toast({type:"success",text:"赠送成功"}),this.visibleSync=!1,this.product.remainNum--,d.a.trackEvent("clk","AvatarShop_GoodsMain_SendEnd",{GoodsId:this.product.itemIdentity,Tuid:e});const t=JSON.parse(this.product.extAttributes).avatarName;d.a.dispatch("action_user_cuteFaceSend",{giftType:"3",targetUserIdEcpt:e,avatarName:t,oriAvatarName:t,cuteFaceGiftId:n.cuteFaceGiftId,userPrivilegeId:String(n.userPrivilegeId),itemIdentity:this.product.itemIdentity})}else this.buyFailHandle(s,a)}):this.showAgreementTips()}buyFailHandle(t,e){d.a.toast({type:"error",text:e}),8e4===t?setTimeout(()=>{d.a.dispatch("action_user_toPay",{sourceCode:"0525"},()=>{})},2e3):20003===t&&(this.product.remainNum=0)}mounted(){const t=d.a.getStorage("SOUL_MARKET_AGREEMENT"),e=document.querySelector(".storage-flag-buy").textContent.replace(/\s/g,"");t===e&&(this.agree=!0)}};Object(n["a"])([Object(r["e"])("visible",{type:Boolean,default:!1})],p.prototype,"visibleSync",void 0),Object(n["a"])([Object(r["d"])()],p.prototype,"product",void 0),Object(n["a"])([Object(r["d"])({required:!1,type:Object})],p.prototype,"stateData",void 0),Object(n["a"])([Object(r["d"])()],p.prototype,"userGender",void 0),Object(n["a"])([Object(r["d"])({default:!1})],p.prototype,"renew",void 0),Object(n["a"])([Object(r["h"])("visible")],p.prototype,"getState",null),p=Object(n["a"])([Object(r["a"])({components:{Agreement:o["a"]}})],p);var v=p,g=v,m=(i("bf48"),i("2877")),b=Object(m["a"])(g,s,a,!1,null,"fbb82558",null);e["a"]=b.exports},e62b8:function(t,e,i){t.exports=i.p+"img/card-1.e8931854.png"},e6a3:function(t,e,i){},ed8c:function(t,e,i){"use strict";i("5b06e")}}]);
//# sourceMappingURL=chunk-c227c5c0.177c38cd.js.map